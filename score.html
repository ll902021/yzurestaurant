<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="author" content="templatemo">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    

    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">

    <title>元智大學學餐評分系統</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">


    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-liberty-market.css">
    <link rel="stylesheet" href="assets/css/owl.css">
    <link rel="stylesheet" href="assets/css/animate.css">
    <link rel="stylesheet"href="https://unpkg.com/swiper@7/swiper-bundle.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><!-- 星星css -->
    <style>
      b{
        color: rgb(255, 255, 255);
      }
      ul.pagination li a {   
          color: blueviolet;
          float: left;
          padding: 8px 16px;
          text-decoration: none;
          transition: background-color .3s;
          border: 1px solid #ddd;
          font-size: 18px;
      }

      ul.pagination li a:hover:not(.active) {background-color: #ddd;}

      .attribute1 {
        color:blueviolet;
        font-size:30px;
        font-family:Microsoft JhengHei;
        font-weight:bold;
      }
      .attribute2 {
        color:aliceblue;
        font-size:20px;
        font-weight:bold;
      }
      .attribute3 {
        font-family:monospace;
      }
      .attribute4{
        font-family:Microsoft JhengHei;
      }
      
      
    </style>
  </head>

<body>
  <!-- ***** Preloader Start ***** -->
  <div id="js-preloader" class="js-preloader">
    <div class="preloader-inner">
      <span class="dot"></span>
      <div class="dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>
  <!-- ***** Preloader End ***** -->

  <!-- ***** Session ***** -->
	<?php
		//session
			// Sessions are always turned on
			if(!isset($_SESSION)){
				session_set_cookie_params(3600,'/');
				session_start();
			}
			
			if(!isset($_SESSION['user_name'])){
				echo '<script>', 'alert("尚未登入");', 'window.location.href="https://yzurestmarking.sytes.net/signin.html";', '</script>';
				exit;
			}
	?>
	
  <!-- ***** 資料庫 ***** -->
	  <?php	
		$host = 'localhost';
		$dbuser = 'collegeres';
		$dbpassword = 'collegeres';
		$dbname = 'collegeres';

		$link = mysqli_connect($host,$dbuser,$dbpassword,$dbname);
		if($link){
			mysqli_query($link,"SET NAMES 'UTF8MB4'");
			// echo "正確連接資料庫";
		}

		$sql = "SELECT `nick`, `idnumber` FROM `member`";
		$result = mysqli_query($link,$sql);
		
		if (mysqli_num_rows($result) > 0) {
				while($row = mysqli_fetch_assoc($result)) {
					if($_SESSION['user_name'] == $row["idnumber"]){
						$nick = $row["nick"];
					}
				} 
			}
	  ?>
	  
	
  <div class="page-heading normal-space">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <h6>YZU Restaurant</h6>
          <h2>評分系統</h2>
          <div class="buttons">
            <div class="main-button">
              <a href="explore.html" style="left:10px;">回選單</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="item-details-page">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="section-heading">
            <div class="line-dec"></div>
            <h2>做出你的<em>評分</em>吧</h2>
          </div>
        </div>
		
        <div class="col-lg-6" style="margin:0px auto;">
          <form id="contact" action="formdb.php" method="post">
            <div class="row">
			  
              <div class="col-lg-12">
                <fieldset>
                  <label for="id">ID number</label>
                  <input type="id" name="id" id="id" value="<?php echo $_SESSION['user_name']; ?>" readonly="readonly">
                </fieldset>
              </div>
			  
			  <div class="col-lg-12 col-xs-12">
                <fieldset>
                  <p style="margin-top:-30px; margin-left:20px; margin-bottom:25px;">(不會顯示在評論頁中)</p>
                </fieldset>
              </div>
			  
			  <div class="col-lg-12">
                <fieldset>
                  <label for="username">Name</label>
                  <input type="username" name="username" id="username" value="<?php echo $nick; ?>" autocomplete="on" required>
                </fieldset>
              </div>
			  
              <div class="col-lg-4">
                <fieldset>
                  <p><label>Choose the Restaurant</label><br>
                    <select name = "rating" required>
                       <option selected></option>
                       <option>自助餐</option>
                       <option>仙桃總鋪</option>
                       <option>陽光早午餐</option>
                       <option>冰窖水果部</option>
                       <option>馺哈料理廚房</option>
                       <option>興仁食堂</option>
                       <option>喜樂早餐</option>
                       <option>天河書屋</option>
                       <option>美而美</option>
                       <option>太發龍美食</option>
                       <option>山口食務所</option>
                       <option>玉食屋</option>
                       <option>呷飽</option>
                       <option>2師兄</option>
                       <option>A華加湯滷味</option>
                       <option>臻品茶</option>
                       <option>雲之羹</option>
                       <option>有銘雞排</option>
                       <option>小木屋</option>
                       <option>卡利亞里(GAY BAR)</option>
                    </select>
                  </p>
                </fieldset>
              </div>

              <!-- ***** 星星 ***** -->
              
              <div class="col-lg-4">
                <div class="rating-box">
                  <fieldset>
                    <label for="opinion">Rating-System<br></label>
                    <div class="rating" >
                      <span class="fa fa-star-o" style="font-size: 30px;"></span>
                      <span class="fa fa-star-o" style="font-size: 30px;"></span>
                      <span class="fa fa-star-o" style="font-size: 30px;"></span>
                      <span class="fa fa-star-o" style="font-size: 30px;"></span>
                      <span class="fa fa-star-o" style="font-size: 30px;"></span>
                      </div>
					  <input type = "hidden" name = "ratescore" id = "ratescore" value = "0">
                      <h4 id="rating-value"></h1>
                    </div>
                  </fieldset>
                </div>
				<script>
					const stars=document.querySelector(".rating").children;
					let ratingValue
					let index //目前選到的星星
					for(let i=0;i<stars.length;i++){
						stars[i].addEventListener("mouseover",function(){
						//  console.log(i)
							for(let j=0;j<stars.length;j++){
								stars[j].classList.remove("fa-star")//reset 所有星星
								stars[j].classList.add("fa-star-o")
							}
							for(let j=0;j<=i;j++){
								stars[j].classList.remove("fa-star-o") //先移除空心的星星
								stars[j].classList.add("fa-star") //添加新的星星 如果i=j表示選中的
							}
						})
						stars[i].addEventListener("click",function(){
							ratingValue=i+1
							index=i
							document.getElementById("ratescore").value = parseInt(ratingValue);
							})
							
						stars[i].addEventListener("mouseout",function(){
							for(let j=0;j<stars.length;j++){
								stars[j].classList.remove("fa-star")//reset 所有星星
								stars[j].classList.add("fa-star-o")
							}
							for(let j=0;j<=index;j++){
								stars[j].classList.remove("fa-star-o")
								stars[j].classList.add("fa-star")
							}
						})
					}
				</script>
              </div>

              <!-- ***** 星星end ***** -->

              <div class="col-lg-12">
                <fieldset>
                  <label for="opinion">Opinion<br></label>
                  <input type="opinion" name="opinion" id="opinion" placeholder="超好吃" autocomplete="on" required rows = "4" cols = "36">
                </fieldset>
              </div>
              <!-- <div class="col-lg-4">
                <fieldset>
                  <label for="file">Upload the photos of food</label>
                  <input type="file" id="file" name="myfiles[]" multiple />
                </fieldset>
              </div> -->
              <div class="col-lg-8" style="margin:0px auto;">
                <fieldset>
                  <button type="submit" id="form-submit" class="orange-button">送出評價</button>
                </fieldset>
              </div>
			  
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

  <script src="assets/js/isotope.min.js"></script>
  <script src="assets/js/owl-carousel.js"></script>

  <!-- <script src="assets/js/rating.js"></script> -->
  

  <script src="assets/js/tabs.js"></script>
  <script src="assets/js/popup.js"></script>
  <script src="assets/js/custom.js"></script>
  
  </body>
</html>